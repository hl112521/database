# 第一章 数据库初探

## 1.1 快速认识数据库

> 数据库是由一批数据构成的集合，这些数据被存放在结构化的数据表里。数据表之间相互关联，反映了客观事物间的本质联系。数据库系统提供对数据的安全控制和完整性控制。本节将介绍数据库中的一些基本概念，包括数据库的定义、数据表的定义和数据类型等。

**[MySQL5.7 安装教程](https://blog.csdn.net/weixin_44051608/article/details/85163823)**

### 1.1.1 什么是数据库

数据库的概念诞生于60年前，随着信息技术和市场的快速发展，数据库技术层不不穷，随着应用的拓展和深入，数据库的数量和规模越来越大，其诞生和发展给计算机信息管理带来一场巨大的革命。

数据库的发展大致划分为人工管理阶段、文件系统阶段、数据库系统阶段和高级数据库阶段。其种类大概有三种，即层次式数据库、网络式数据库和关系式数据库。不同种类的数据库按不同的数据结构来联系和组织。

对于数据库的概念，没有一个完全固定的定义，随着数据库历史的发展，定义的内容也有很大的差异，其中一种比较普遍的观点认为数据库（Database， DB）是一个长期存储在计算机内的、有组织的、有共享的、统一管理的数据集合。它是一个按数据结构来存储和管理数据的计算机软件系统，即数据库包含两层含义——保管数据的
“仓库”以及数据管理的方法和技术。

数据库的特点包括实现数据共享，减少数据冗余；采用特定的数据类型；具有较高的数据独立性；具有统一的数据控制功能。

### 1.1.2 数据库的原理

数据库（Database）是一些相关数据的集合，用户可以用一定的原则和方法添加、编辑和删除数据的内容，进而对所有数据进行搜索、分析及比对，取得可用的信息，产生所需的结果。

在一个数据库中不是只能保存一些简单的数据，可以将不同的数据内容保存在同一个数据库中，例如在进行销存管理系统中，可以同时将货物数据与厂商数据保存在同一个数据库文件中，这样在归类及管理时较为方便。

若不同类的数据之间有关联，还可以彼此使用。例如，可以查询出某种产品的名称、规格及价格，而且可以利用其厂商编号查询到厂商名称及联系电话。通常称保存在数据库中的不同类别的记录集合为数据表（Table），在一个数据库中可以保存多个数据表，而每个数据表之间并不是互不相干的，如果有关联，可以协同作业、彼此合作。数据库关联如图1-1所示。

![](img/图1-1 数据库关联.png)

<div align = "center" style="font-weight:bold">图1-1 数据库关联</div>
每一个数据表都由一个个字段组合起来，例如，在产品数据表中可能会有产品编号、产品名称和产品价格等字段，只需按照一个个字段的设置输入数据即可完成一个完整的数据库，如图1-2所示。

![](img/图1-2 数据库表.png)

<div align = "center" style="font-weight:bold">图1-2 数据库表</div>
这里有一个很重要的概念，一般人认为数据库是保存数据的地方，这是不对的，其实数据表才是真正保存数据的地方，数据库是放置数据表的场所。

### 1.1.3 数据表

在关系数据库中，数据库表是一系列二维数组的集合，用来存储数据和操作数据的逻辑结构。它由纵向的列和横向的行组成，行被称为**记录**，是组织数据的单位；列被称为字段，每一列表示记录的一个属性，都有相应的描述信息，例如数据类型、数据宽度等。

### 1.1.4 数据类型

数据类型决定了数据在计算机中的存储格式，代表不同的信息类型。常用的数据类型有整形数据类型、浮点数数据类型、精确小数类型、二进制数据类型、日期/时间数据类型、字符串数据类型。

表中的每一个字段类型就是某种指定数据类型，例如 student 表中的“学号”字段类型为整数数据，“性别”字段为字符型数据类型。

### 1.1.5 主键

主键（PRIMARY KEY）又称主码，用于唯一地标识表中的每一条记录。用户可以定义表中的一列或多列为主键，注意主键列上不能有两行相同的值，也不能为空值。假如定义 student 表，该表给每一个学生分配一个“学号”，该编号作为数据表的主键，如果出现相同的值，将提示错误，系统不能确定查询的究竟是哪一条记录；如果把学生的“姓名”作为主键，则不能出现重复的名字，这与现实不相符，因此“姓名”字段不适合作为主键。

## 1.2 数据库技术构成

> 数据库系统由硬件部分和软件部分共同构成，硬件主要用于存储数据库中的数据，包括计算机、存储设备等；软件部分则主要包括DBMS、支持DBMS运行的操作系统，以及支持多种语言进行应用开发的访问技术等。本节将介绍数据库技术构成。

### 1.2.1 数据库系统

数据库系统有以下3个主要组成部分。

- 数据库：用于存储数据的地方。
- 数据库管理系统：用于管理数据库的软件。
- 数据库应用程序：为了提高数据库系统的处理能力所使用的管理数据库的软件补充。

数据库（Database System）提供了一个存储空间用于存储各种数据，可以将数据库视为一个存储数据的容器。一个数据库中可能包含许多文件，一个数据库系统中通常包含许多数据库。

数据库管理系统（Database Management System，DBMS）是用户创建、管理和维护数据库时所使用的软件，位于用户与操作系统之间，对数据库进行统一管理。DBMS能定义数据存储结构，提供数据的操作机制，维护数据库的安全性、完整性和可靠性。

数据库应用程序（Database Application）虽然已经有了DBMS，但是在很多情况下DBMS无法满足对数据库管理的要求。数据库应用程序的使用可以满足对数据管理的更高要求，还可以使数据管理过程更加直观友好。数据库应用程序负责与DBMS进行通信，访问和管理DBMS中存储的数据，允许用户插入、修改、删除数据库中的数据。

数据库系统如图1-3所示。

![](img/图1-3 数据库系统.png)

<div align = "center" style="font-weight:bold">图1-3 数据库系统</div>
### 1.2.2 SQL语言

对数据库进行查询和修改操作的语言叫SQL，SQL的含义是结构化查询语言（Structured Query Language）。SQL有许多不同的类型，有3个主要的标准：对ANSI（美国国家标准机构）SQL修改后在1992年采纳的标准，成为SQL-92或SQL2。最近的SQL-99标准，SQL-99标准从SQL2扩充而来并增加了对象关系特征和许多其他新功能；各大数据库厂商提供不同版本的SQL，这些版本的SQL不仅能包括原始的ANSI标准，而且在很大程度上支持新推出的SQL-92标准。

SQL语言包含以下4个部分。

1. 数据定义语言（DDL）：DROP、CREATE、ALTER等语句。
2. 数据操作语言（DML）：INSERT（插入）、UPDATE（修改）、DELETE（删除）语句。
3. 数据查询语言（DQL）：SELECT语句。
4. 数据控制语言（DCL）：GRANT、REVOKE、COMMIT、ROLLBACK等语句。

### 1.2.3 数据库访问技术

**JDBC**

JDBC（Java Database Connectivity，Java数据库连接）是用于Java应用程序连接数据库的标准方法，是一种用于执行 SQL 语句的 Java API，可以作为多种关系数据库提供统一访问，它由一组用Java语言编写的类和接口组成。

## 1.3 关系型数据模型

> MySQL数据库属于关系型数据库，所以我们需要了解关系型数据模型的相关知识。

### 1.3.1 关系型数据模型的结构

建立数据库系统离不开数据模型。模型是对现实世界的抽象，在数据库技术中用模型的概念描述数据库的结构与语义，对现实世界进行抽象，能表示实体类型及实体间联系的模型称为“数据模型”。

数据模型的种类有很多，目前被广泛使用的可分为两种类型。一种是独立于计算机系统的数据模型，完全不涉及信息在计算机中的表示，只是用来描述某个特定组织所关心的信息结构，这种模型称为“概念数据模型”。概念数据模型是按用户的观点对数据建模，强调其语义表达能力，概念应该简单、清晰、易于用户理解，它是对现实世界的第一层抽象，是用户和数据库设计人员之间进行交流的工具。其典型代表就是著名的“实体-关系模型”。

另一种数据模型是直接面向数据库的逻辑结构，它是对现实世界的第二层抽象。这种模型直接与数据库管理系统有关，称为“逻辑数据模型”，包括层次模型、网状模型、关系模型和面向对象模型。逻辑数据模型应该包含数据结构、数据操作和数据完整性约束3个部分，通常有一组严格定义的无二义性语法和语义的数据库语言，人们可以用这种语言来定义、操作数据库中的数据。

在逻辑数据模型的4种模型中，层次模型和网状模型已经很少应用，而面向对象模型比较复杂，尚未达到关系模型数据库的普及程度。目前理论成熟、使用普及的模型就是关系模型。

关系模型是由若干个关系模式组成的集合，关系模式的实例称为关系，每个关系实际上是一张二维表格。关系模型用键导航数据，其表格简单，用户只需用简单的查询语句就可以对数据库进行操作，并不涉及存储结构、访问技术等细节。SQL 语言是关系数据库的代表性语言，已经得到了广泛的应用。典型的关系数据库产品有DB2、Oracle、Sybase、SQL Server等。 

关系数据库是以关系模型为基础的数据库，是根据表、元组、字段之间的关系进行组织和访问数据的一种数据库，它通过若干个表来存取数据，并且通过关系将这些表联系在一起。关系数据库是目前应用最广泛的数据库。关系数据是支持关系模型的数据库，下面先介绍关系数据模型。 

 目前，在实际数据库系统中支持的数据模型主要有3种，即层次模型（Hierarchical Model)、网状模型（Network Model)和关系模型（Relational odel).自20世纪80年代以来，计算机厂商推出的数据库管理系统几乎都是支持关系模型的数据库系统，关系模型已经占领市场主导地位。

关系模型有3个组成部分，即`数据结构`、`数据操作`和`完整性规则`。

关系模型建立在严格的数学概念的基础之上，它用二维表来描述实体与实体间的联系。

例如在一个有关学生信息的名为 student的表中，每个列包含所有作者的某个特定类型的信息，比如姓名，而每行包含了某个特定作者的所有信息，比如学号、姓名、性别、专业，如图1-4所示。 

![](img/图1-4 数据库字段.png)

<div align = "center" style="font-weight:bold">图1-4 数据库字段</div>
 关系模型的基本术语如下。

- 关系（Relation):一个二维表就是一个关系。
- 元组（Tuple):二维表中的一行即为一个元组。
- 属性（Attribute):二维表中的一列即为一个属性，给每个属性取一个名称即属性名。
- 域（Domain):属性的取值范围。

关系模式是对关系的描述，可表示为关系名（属性1,属性2,···,属性n).例如上面的关系可以描述为学生（学号，姓名，性别，专业）。

一个关系模型是若干个关系模式的集合。在关系模型中，实体以及实体间的联系都用关系来表示。例
如学生、课程、学生与课程之间的多对多联系在关系模型中可以如下表示：

学生（学号，姓名，性别，专业）

课程（课程号，课程名，学分）

选修（学号，课程号，成绩）

由于关系模型概念简单、清晰、易懂、易用，并有严密的数学基础以及在此基础上发展起来的关系数据理论，化了程序开发及数据库建立的工作量，因而迅速获得了广泛的应用，并在数据库系统中占据了统治地位。 

### 1.3.2 关系型数据模型的操作与完整性

 关系模型提供了一组完备的高级关系运算，以支持对数据库的各种操作。关系数据库的数据操作语言（DML）的语句分为查询语句和更新语句两大类，查询语句用于描述用户的各类检索要求；更新语句用于描述用户的插入、修改和删除等操作。关系数据操作语言建立在关系代数的基础之上，具有以下特点。

（1）以关系为单位进行数据操作，操作的结果也是关系。

（2）非过程性强：很多操作只需指出做什么，而无须步步引导怎么去做。

（3）以关系代数为基础，借助于传统的集合运算和专门的关系运算，使关系数据语言具有很强的数据操作能力。 

 下面介绍在数据操作语言中对数据库进行查询和更新等操作的语句。

1. **SELECT···INTO语句**：用于创建一个查询表。
2. **INSERT INTO语句**：用于向一个表中添加一个或多个记录。
3. **SELECT语句**：按指定的条件在一个数据库中查询的结果，返回的结果被看作记录的集合。
4. **UPDATE 语句**：用于创建一个更新查询，根据指定的条件更改指定表中的字段值。UPDATE 语句不生成结果集，而且在使用更新查询更新记录之后不能取消这次操作。
5. **DELETE语句**：用于创建一个删除查询，可以从列在FROM子句之中的一个或多个表中删除记录，且该子句满足WHERE子句中的条件，可以使用DELETE删除多个记录。
6. **INNER JOIN操作**：用于组合两个表中的记录，只要在公共字段之中有相符的值即可。用户可以在任何FROM子句中使用INNER JOIN运算。这是最普通的连接类型，只要在这两个表的公共字段之中有相符的值，内部连接就将组合两个表中的记录。
7. **LEFT JOIN操作**：用于在任何FROM子句中组合来源表的记录。使用LEFT JOIN 运算创建一个左边外部连接。左边外部连接将包含从第一个（左边）开始的两个表中的全部记录，即使在第二个（右边）表中并没有相符值的记录。
8. **RIGHT JOIN操作**：用于在任何FROM子句中组合来源表的记录。使用RIGHT JOIN 运算创建一个右边外部连接。右边外部连接将包含从第二个（右边）表开始的两个表中的全部记录，即使在第一个（左边）表中并没有相符值的记录。
9. **PARAMETERS 声明**：用于声明参数查询中的每一个参数的名称及数据类型。PARAMETERS声明是可选的，但是当使用时需要置于任何其他语句之前，包括 SELECT语句。
10. **UNION 操作**：用于创建一个联合查询，它组合了两个或更多的独立查询或表的结果。所有在一个联合运算中的查询都需要请求相同数目的字段，但是字段不必大小相同或数据类型相同。 

 根据关系数据理论和Codd 准则的定义，一种语言必须能处理与数据库的所有通信问题，这种语言有时也称为“综合数据专用语言”。该语言在关系型数据库管理系统中就是SQL。SQL的使用主要通过数据操作、数据定义和数据管理来实现。其中Codd提出了RDBMS的12项准则。

1. **信息准则**：关系数据库中的所有信息都应在逻辑一级上用一种方法，即表中的值显示的表示。
2. **保证访问准则**：依靠于表名、主键和列名，保证能以逻辑的方式访问数据库中的每个数据项。
3. **空值的系统化处理**：RDBMS 支持空值（不同于空的字符串或空白字符串，并且不为0）系统化地表示缺少的信息，且与数据类型无关。
4. **基于关系模型的联机目录**：数据库的描述在逻辑上应该和普通数据采用同样的方式，使得授权用户可以使用查询一般数据所用的关系语言来查询数据库的描述信息。
5. **统一的数据子语言准则**：一个关系系统可以具有多种语言和多种终端使用方式（例如表格填空方式、命令行方式等），但是必须有一种语言，它的语句可以表示为具有严格语法规定的字符串，并能全面地支持数据定义、视图定义、数据操作（交互式或程序式）、完整约束、授权、事务控制（事务开始、提交、撤销）等功能。
6. **视图更新准则**：所有理论上可更新的视图也应该允许由系统更新。
7. **高阶的插入、更新和删除**：把一个基本关系或导出关系作为一个操作对象进行数据的检索以及插入、更新和删除。
8. **数据的物理独立性**：无论数据库的数据在存储表示上或存取方法上做任何变化，应用程序和终端活动要都保持逻辑上的不变性。
9. **数据的逻辑独立性**：当基本表中进行理论上信息不受损害的任何变化时，应用程序和终端活动都要 保持逻辑上的不变形。
10. **数据完整性的独立性**：关系数据库的完整性约束必须是用数据子语言定义并存储在目录中的，而不是在应用程序中加以定义的。至少要支持以下两种约束：实体完整性，即主键中的属性不允许为NULL；参照完整性，即对于关系数据库中每个不同的非空的外码值必须存在一个取自同一个域匹配的主键值。
11. **分布的独立性**：一个RDBMS应该具有分布独立性。分布独立性是指用户不必了解数据库是否为分布式的。
12. **无破坏准则**：如果RDBMS 有一个低级语言（一次处理一个记录），这一低级语言不能违背或绕过完整性准则以及高级关系语言（一次处理若干记录）表达的约束。

数据库管理系统是对数据进行管理的大型系统软件，它是数据库系统的核心组成部分，用户在数据库系统中的一切操作（包括数据定义、查询、更新及各种控制）都是通过DBMS进行的。

关系模型的完整性规则是对数据的约束。关系模型提供了3类完整性规则，即实体完整性规则、参照完整性规则和用户定义的完整性规则。其中，实体完整性规则和参照完整性规则是关系模型必须满足的完整性约束条件，称为关系完整性规则。

- 实体完整性约束：约束关系的主键中属性值不能为空值。空值（null）就是指不知道或者不能使用的值，它与数值0和空字符串的意义都不一样。
- 参照完整性约束：关系之间的基本约束。如果关系的外键R1与关系R2的主键相符，那么外键的每个值必须在关系R2的主键的值中找到或者是空值。
- 用户定义的完整性约束：它反映了具体应用中数据的语义要求，针对某一具体的实际数据库的约束条件。它由应用环境所决定，反映某一具体应用所涉及的数据必须满足的要求。关系模型提供了定义和检验这类完整性的机制，以便用统一的、系统的方法处理，而不必由应用程序承担这一功能。 

### 1.3.3 关系型数据模型的存储结构

 关系型数据模型是以关系数学理论为基础的，用二维表结构来表示实体以及实体之间联系的模型称为关系模型。在关系模型中把数据看成是二维表中的元素，操作的对象和结果都是二维表，一张二维表就是一个关系。关系模型与层次模型、网状模型的本质区别在于数据描述的一致性，模型概念单一。在关系型数据库中，每一个关系都是一个二维表，无论是实体本身还是实体间的联系均用称为“关系”的二维表来表示，它由表名、行和列组成。表的每一行代表一个元组，每一列称为一个属性，这使得描述实体的数据本身能够自然地反映它们之间的联系。传统的层次和网状模型数据库是使用链接指针来存储和体现联系的。尽管关系型数据库管理系统比层次型和网状型数据库管理系统的出现晚了很多年，但关系型数据库以其完备的理论基础、简单的模型、说明性的查询语言和使用方便等优点得到了最广泛的应用。

## 1.4 关系型数据模型中的数据依赖与范式

 在数据库中，数据之间存在着密切的联系。关系数据库由相互联系的一组关系组成，每个关系包括关系模式和关系值两个方面。关系模式是对关系的抽象定义，给出关系的具体结构；关系的值是关系的具体内容，反映关系在某一时刻的状态。一个关系包含许多元组，每个元组都是符合关系模式结构的一个具体值，并且都分属于相应的属性。在关系数据库中每个关系都需要进行规范化，使之达到一定的规范化程度，从而提高数据的结构化、共享性、一致性和可操作性。

关系模型原理的核心内容就是规范化概念，规范化是把数据库组织成在保持存储数据完整性的同时最小化冗余数据的结构的过程。规范化的数据库必须符合关系模型的范式规则。范式可以防止在使用数据库时出现不一致的数据，并防止数据丢失。关系模型的范式有第一范式、第二范式、第三范式和BCNF范式等多种。

在这些定义中，高级范式根据定义属于所有低级的范式，例如第三范式中的关系属于第二范式，第二范式中的关系属于第一范式。下面介绍规范化的过程。

**1. 第一范式**

第一范式是第二和第三范式的基础，是最基本的范式。第一范式包括下列指导原则：

- 数据组的每个属性只可以包含一个值。
- 关系中的每个数组必须包含相同数量的值。
- 关系中的每个数组一定不能相同。

如果关系模式R中的所有属性值都是不可再分解的原子值，那么就称此关系R是第一范式（First NormalForm，1NF）的关系模式。在关系型数据库管理系统中涉及的研究对象都是满足1NF的规范化关系，不是1NF的关系称为非规范化的关系。

**2. 第二范式**

第二范式（2NF）规定关系必须在第一范式中，并且关系中的所有属性依赖于整个候选键。[候选键](https://baike.baidu.com/item/%E5%80%99%E9%80%89%E9%94%AE/11032985?fr=aladdin)是一个或多个唯一标识每个数据组的属性集合。

**3. 第三范式**

第三范式（3NF）和2NF一样依赖于关系的候选键。为了遵循3NF的指导原则，关系必须在2NF中，非键属性相互之间必须无关，并且必须依赖于键。

对于关系设计，理想的设计目标是按照规范化规则存储数据。但是，在数据库实现的现实世界中将数据解规范化却是通用的惯例，也就是要专门违反规范化规则，尤其是违反第二范式和第三范式。当过于规范化的结构使实现方式复杂化时，解规范化主要用于提高性能或减少复杂性。尽管如此，规范化的目标仍然是确保数据的完整性，在解规范化时应该注意。

## 1.5 常见的关系型数据库管理系统

> 常见的关系型数据库管理产品有Oracle、SQL Server、Sybase、DB2、Access等。

 **1. Oracle**

Oracle 是1983年推出的世界上第一个开放式商品化关系型数据库管理系统。它采用标准的SQL 结构化查询语言，支持多种数据类型，提供面向对象存储的数据支持，具有第四代语言开发工具，支持UNIX、Windows NT、OS／2、Novell 等多种平台。除此之外，它还具有很好的并行处理功能。Oracle 产品主要由Oracle 服务器产品、Oracle 开发工具、Oracle 应用软件组成，也有基于微机的数据库产品，主要满足对银行、金融、保险等企业和事业开发大型数据库的需求。

 **2. SQL Server**
SQL 即结构化查询语言（Structured Query Language，SQL）。SQL Server最早出现在1988年，当时只能在OS／2操作系统上运行。2000年12月微软公司发布了SQL Server 2000，该软件可以运行在WindowsNT／2000／XP等多种操作系统之上，是支持客户机／服务器结构的数据库管理系统，它可以帮助各种规模的企业管理数据。

随着用户群的不断增大，SQL Server在易用性、可靠性、可收缩性、支持数据仓库、系统集成等方面日趋完美，特别是SQL Server的数据库搜索引擎，可以在绝大多数的操作系统之上运行，并针对海量数据的查询进行了优化。目前SQL Server已经成为应用最广泛的数据库产品之一。

由于使用 SQL Server 不仅要掌握SQL Server的操作，还要熟练掌握Windows NT／2000 Server的运行机制以及SQL语言，所以非专业人员学习和使用有一定的难度。

**3. Sybase**
1987年推出的大型关系型数据库管理系统Sybase能运行于OS／2、UNIX、Windows NT等多种平台，它支持标准的关系型数据库语言SQL，使用客户机／服务器模式，采用开放体系结构，能实现网络环境下各节点上服务器的数据库互访操作，技术先进、性能优良，是开发大中型数据库的工具。Sybase 产品主要由服务器产品 Sybase SQL Server、客户产品 Sybase SQL Toolset和接口软件Sybase Client／Server Interface组成， 还有著名的数据库应用开发工具 PowerBuilder。

**4. DB2**

DB2是基于SQL的关系型数据库产品。在20世纪80年代初期DB2的重点放在大型的主机平台上，到90年代初，DB2发展到中型机、小型机以及微机平台。DB2适用于各种硬件与软件平台。各种平台上的DB2有共同的应用程序接口，运行在一种平台上的程序可以很容易地移植到其他平台。DB2的用户主要分布在金融、商业、铁路、航空、医院、旅游等各个领域，以金融系统的应用最为突出。

**5. Access**

Access 是在Windows操作系统下工作的关系型数据库管理系统。它采用了Windows程序设计理念，以Windows特有的技术设计查询、用户界面、报表等数据对象，内嵌了VBA（全称为Visual Basic Application）程序设计语言，具有集成的开发环境。Access 提供图形化的查询工具和屏幕、报表生成器，用户建立复杂的报表、界面无须编程和了解SQL语言，它会自动生成SQL代码。

Access 被集成到 Office中，具有Office系列软件的一般特点，例如菜单、工具栏等。与其他数据库管理系统软件相比，它更加简单易学，一个普通的计算机用户，即使没有程序语言基础，仍然可以快速地掌握和使用它。最重要的一点是，Access的功能比较强大，足以应付一般的数据管理及处理需要，适用于中小型企业数据管理的需求。当然，在数据定义、数据安全可靠、数据有效控制等方面，它比前面几种数据库产品要逊色不少。